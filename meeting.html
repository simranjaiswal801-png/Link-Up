<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>LinkUP Room</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Poppins}

/* background */
body{
background: radial-gradient(circle at bottom,#0b0f25 0%,#05070f 40%,#000 100%);
color:white;
height:100vh;
display:flex;
flex-direction:column;
}

/* popup */
.popup{
position:fixed;
inset:0;
background:rgba(0,0,0,0.75);
display:flex;
justify-content:center;
align-items:center;
z-index:10;
}

.popup-box{
background:rgba(255,255,255,0.05);
backdrop-filter:blur(18px);
border:1px solid rgba(255,255,255,0.2);
padding:35px;
border-radius:22px;
text-align:center;
width:360px;
box-shadow:0 0 50px rgba(255,0,150,.4);
animation:pop .4s ease;
}

@keyframes pop{
from{transform:scale(.7);opacity:0}
to{transform:scale(1);opacity:1}
}

.popup input{
width:100%;
padding:14px;
border-radius:12px;
border:none;
margin:18px 0;
background:rgba(255,255,255,0.1);
color:white;
}

.share-icons button{
font-size:24px;
margin:6px;
border:none;
background:transparent;
cursor:pointer;
transition:.3s;
color: white;
}
.share-icons button:hover{transform:scale(1.3)}
/* smooth animated chat */
.side-panel{
  transform: translateX(100%);
  transition: transform 0.35s ease, opacity 0.35s ease;
  opacity: 0;
}

.side-panel.show{
  transform: translateX(0);
  opacity: 1;
}

.close{
margin-top:18px;
padding:13px 35px;
border:none;
border-radius:40px;
background:linear-gradient(90deg,#ff3fa4,#ff7cc8);
color:white;
font-weight:600;
cursor:pointer;
}

/* layout */
.room{flex:1;display:flex}

.video-area{
flex:1;
display:flex;
justify-content:center;
align-items:center;
flex-wrap:wrap;
gap:20px;
padding:20px;
}


video{
width:100%;
max-width:900px;
height:auto;
aspect-ratio:16/9;
object-fit:cover;
border-radius:18px;
border:1px solid rgba(255,255,255,0.2);
transition:.3s;
}


.user-name{
position:absolute;
bottom:40px;
background:rgba(0,0,0,0.6);
padding:6px 15px;
border-radius:20px;
}

/* sidebar */
.side-panel{
width:280px;
background:rgba(255,255,255,0.05);
border-left:1px solid rgba(255,255,255,0.15);
display:flex;
flex-direction:column;
padding:15px;
}

.messages{
flex:1;
overflow-y:auto;
margin:10px 0;
}

.msg{
background:#ff3fa4;
padding:6px 10px;
border-radius:12px;
margin:6px 0;
display:inline-block;
}

#msgInput{
padding:12px;
border-radius:10px;
border:none;
}
@keyframes float{
0%{transform:translate(-50%,0);opacity:1}
100%{transform:translate(-50%,-200px);opacity:0}
}

/* toolbar */
.toolbar{
display:flex;
justify-content:center;
align-items:center;
flex-wrap:wrap;   /* â­ important */
gap:15px;
padding:15px;
background:rgba(255,255,255,0.05);
backdrop-filter:blur(10px);
}

.msg{
  animation: msgPop .25s ease;
}

@keyframes msgPop{
  from{
    transform: translateY(8px);
    opacity:0;
  }
  to{
    transform: translateY(0);
    opacity:1;
  }
}

.toolbar button{
width:60px;
height:60px;
border-radius:15px;
border:none;
font-size:22px;
cursor:pointer;
background:rgba(255,255,255,0.08);
color:white;
transition:.3s;
}
.toolbar button:hover{background:#ff3fa4;transform:scale(1.1)}

/* tools panel */
.tool-panel{
position:fixed;
right:20px;
top:80px;
width:320px;
height:420px;
background:#0b0f25;
border-radius:20px;
padding:15px;
display:none;
transition:.3s;
flex-direction:column;
box-shadow:0 0 40px rgba(255,0,150,.4);
}

canvas{
background:white;
border-radius:10px;
}
.speaking{
box-shadow:0 0 25px #00ffae;
border-radius:20px;
}

textarea{
flex:1;
resize:none;
border:none;
padding:10px;
border-radius:10px;
}
.participants{
border-bottom:1px solid rgba(255,255,255,0.15);
padding-bottom:10px;
margin-bottom:10px;
}
#users div{
background:rgba(255,255,255,0.08);
padding:6px 10px;
border-radius:10px;
margin:6px 0;
font-size:14px;
}
.participants{
position:absolute;
right:0;
top:0;
height:100%;
transform:translateX(100%);
transition:.35s;
opacity:0;
}
.popup-box{
animation:zoom .35s ease;
}

@keyframes zoom{
from{transform:scale(.6);opacity:0}
to{transform:scale(1);opacity:1}
}


.participants.show{
transform:translateX(0);
opacity:1;
}

.user{
padding:10px;
margin:6px 0;
background:rgba(255,255,255,.08);
border-radius:10px;
font-size:14px;
}
.host-panel{
position:fixed;
left:20px;
top:80px;
width:260px;
background:#0b0f25;
padding:18px;
border-radius:20px;
display:none;
flex-direction:column;
box-shadow:0 0 40px rgba(255,0,150,.4);
animation:fade .3s;
}
.wait-btns{
display:flex;
gap:15px;
margin-top:20px;
justify-content:center;
}

.enterBtn{
padding:12px 25px;
border:none;
border-radius:30px;
background:linear-gradient(90deg,#ff3fa4,#ff7cc8);
color:white;
font-weight:600;
cursor:pointer;
transition:.3s;
}

.enterBtn:hover{
transform:scale(1.07);
}

.cancelBtn{
padding:12px 25px;
border:none;
border-radius:30px;
background:rgba(255,255,255,0.1);
color:white;
cursor:pointer;
transition:.3s;
}

.cancelBtn:hover{
background:red;
}



@keyframes fade{
from{opacity:0;transform:translateY(-10px)}
to{opacity:1;transform:translateY(0)}
}
.spot{
grid-column:span 2;
grid-row:span 2;
height:420px !important;
z-index:2;
box-shadow:0 0 40px #ff3fa4;
}

.host-panel button{
margin:6px 0;
padding:10px;
border:none;
border-radius:12px;
cursor:pointer;
background:rgba(255,255,255,.08);
color:white;
}

.host-panel button:hover{
background:#ff3fa4;
}

.host-user{
display:flex;
justify-content:space-between;
background:rgba(255,255,255,.08);
padding:8px;
margin-top:6px;
border-radius:10px;
}


</style>
</head>
<body>
<!-- POPUP -->
<div class="popup" id="popup">
<div class="popup-box">
<h2>Invite Friends</h2>

<input id="meetingLink">

<div class="share-icons">

<button onclick="copyLink()"><i class="fas fa-copy"></i></button>

<button onclick="shareWhatsApp()"><i class="fab fa-whatsapp"></i></button>

<button onclick="shareMessenger()"><i class="fab fa-facebook-messenger"></i></button>

<button onclick="directShare()"><i class="fas fa-share-alt"></i></button>

</div>


<button class="close" onclick="closePopup()">Start Meeting</button>
</div>
</div>

<!-- ROOM -->
<div class="room">

<div class="video-area">
<video autoplay muted id="video"></video>
<div class="user-name">You</div>
</div>
<div class="user-name">
You <span id="micStatus" style="font-size:12px;color:#aaa;">ğŸ¤ On</span>
</div>

<div class="side-panel" id="chatPanel">
<h3 style="border-bottom:1px solid rgba(255,255,255,.2);padding-bottom:10px;">
ğŸ’¬ Chat
</h3>
<div class="messages" id="messages"></div>
<input id="msgInput" placeholder="Type message...">
</div>
<!-- PARTICIPANTS PANEL -->
<div class="side-panel participants" id="participantsPanel">
<h3>ğŸ‘¥ Participants</h3>
<div id="userList"></div>
</div>

<div class="participants">
<h3>Participants</h3>
<div id="users">
<div>ğŸŸ¢ You (Host)</div>
</div>
</div>

</div>
<!-- TOOLBAR -->
<div class="toolbar">
<button onclick="toggleCam()">ğŸ¥</button>
<button id="micBtn" onclick="toggleMic()">ğŸ¤</button>
<button onclick="shareScreen()">ğŸ–¥</button>
<button onclick="raiseHand()">âœ‹</button>
<button onclick="record()">âº</button>
<button onclick="whiteboard()">ğŸ“</button>
<button onclick="toggleHostPanel()">ğŸ›¡</button>
<button onclick="breakout()">ğŸ§©</button>
<button onclick="notes()">ğŸ“’</button>
<button onclick="toggleChat()">ğŸ’¬</button>
<button class="endBtn" onclick="endMeeting()">âŒ</button>
<button onclick="emojiReact()">ğŸ˜</button>
<button onclick="blurBg()">ğŸŒ«</button>


<button onclick="muteAll()">ğŸ”‡</button>
<button onclick="toggleParticipants()">ğŸ‘¥</button>

</div>

<!-- TOOL PANEL -->
<div class="tool-panel" id="panel"></div>
<div class="host-panel" id="hostPanel">

<h3>Host Controls</h3>

<button onclick="muteAll()">Mute All</button>
<button onclick="stopAllVideo()">Stop All Video</button>
<button onclick="lockMeeting()">ğŸ”’ Lock Meeting</button>

<hr>

<h4>Participants</h4>
<div id="hostUsers"></div>

</div>

<script>
const video=document.getElementById("video");
let stream;

/* start camera */
navigator.mediaDevices.getUserMedia({video:true,audio:true})
.then(s=>{stream=s;video.srcObject=s});

/* popup */
document.getElementById("meetingLink").value=location.href;

function closePopup(){document.getElementById("popup").style.display="none"}

/* copy link */
function copyLink(){
navigator.clipboard.writeText(location.href);
alert("Link copied!");
}

/* toggles */
function toggleCam(){
let t=stream.getVideoTracks()[0];
t.enabled=!t.enabled;
}
function toggleMic(){
let t=stream.getAudioTracks()[0];
t.enabled=!t.enabled;
}
function muteAll(){
stream.getAudioTracks().forEach(t=>t.enabled=false);
alert("All participants muted!");
}
function leaveMeeting(){
location.href="index.html"; // ya home page
}


/* screen */
async function shareScreen(){
let s=await navigator.mediaDevices.getDisplayMedia({video:true});
video.srcObject=s;
}
function blurBg(){
video.style.filter =
video.style.filter==="blur(8px)" ? "none" : "blur(8px)";
}

/* recording */
let recording=false;

function record(){
recording=!recording;

let badge=document.getElementById("recBadge");

if(recording){
if(!badge){
badge=document.createElement("div");
badge.id="recBadge";
badge.innerHTML="ğŸ”´ Recording";
badge.style.position="fixed";
badge.style.top="20px";
badge.style.left="50%";
badge.style.transform="translateX(-50%)";
badge.style.background="red";
badge.style.padding="8px 20px";
badge.style.borderRadius="30px";
document.body.appendChild(badge);
}
}else{
document.getElementById("recBadge")?.remove();
}
}


function toggleChat(){
  const panel = document.getElementById("chatPanel");
  panel.classList.toggle("show");
}
function toggleParticipants(){
document.getElementById("participantsPanel").classList.toggle("show");
}


msgInput.onkeypress=e=>{
if(e.key==="Enter"){
let div=document.createElement("div");
div.className="msg";
div.textContent=e.target.value;
messages.appendChild(div);
e.target.value="";
}
}
function raiseHand(){
let tag=document.createElement("div");
tag.textContent="âœ‹ Hand Raised";
tag.style.position="fixed";
tag.style.bottom="120px";
tag.style.left="50%";
tag.style.transform="translateX(-50%)";
tag.style.background="#ff3fa4";
tag.style.padding="10px 20px";
tag.style.borderRadius="20px";
document.body.appendChild(tag);

setTimeout(()=>tag.remove(),2000);
}

/* tools */
function openPanel(html){
let p=document.getElementById("panel");

if(p.style.display==="flex"){
p.style.display="none";
return;
}

p.innerHTML = `
<div style="text-align:right">
<button onclick="closePanel()" style="background:red;color:white;border:none;border-radius:8px;padding:4px 10px;cursor:pointer">X</button>
</div>
` + html;

p.style.display="flex";
}

function closePanel(){
document.getElementById("panel").style.display="none";
}


function whiteboard(){
openPanel(`<canvas id="board" width=280 height=340></canvas>`);
let c=document.getElementById("board");
let ctx=c.getContext("2d");
let draw=false;
c.onmousedown=()=>draw=true;
c.onmouseup=()=>draw=false;
c.onmousemove=e=>{
if(!draw)return;
ctx.fillRect(e.offsetX,e.offsetY,3,3);
};
}
function toggleMic(){
let t = stream.getAudioTracks()[0];
t.enabled = !t.enabled;

let btn = document.getElementById("micBtn");
let status = document.getElementById("micStatus");

if(t.enabled){
btn.textContent = "ğŸ¤";
status.textContent = "ğŸ¤ On";
status.style.color = "#aaa";
}else{
btn.textContent = "ğŸ”‡";
status.textContent = "ğŸ”‡ Muted";
status.style.color = "red";
}
}


function notes(){
openPanel(`<textarea placeholder="Write notes..."></textarea>`);
}
function enterMeeting(){
document.getElementById("waitingRoom").style.display="none";
}

function endMeeting(){

if(confirm("Are you sure you want to leave meeting?")){

// stop camera + mic
stream.getTracks().forEach(track=>track.stop());

// redirect page
window.location.href="index.html"; 
}
}

function react(){
let e=document.createElement("div");
e.textContent=["ğŸ‘","ğŸ˜‚","ğŸ‘","ğŸ”¥","â¤ï¸"][Math.floor(Math.random()*5)];
e.style.position="fixed";
e.style.left="50%";
e.style.bottom="120px";
e.style.fontSize="40px";
e.style.animation="float 2s linear forwards";
document.body.appendChild(e);
setTimeout(()=>e.remove(),2000);
}
const users=["You","Rahul","Priya","Alex"];

const list=document.getElementById("userList");
users.forEach(u=>{
let div=document.createElement("div");
div.className="user";
div.textContent=u;
list.appendChild(div);
});
function shareWhatsApp(){
window.open(`https://wa.me/?text=${location.href}`,"_blank");
}

function shareMessenger(){
window.open(`https://www.facebook.com/dialog/send?link=${location.href}`,"_blank");
}
function adjustLayout(){
const videos=document.querySelectorAll("video");

videos.forEach(v=>{
if(videos.length===1){
v.style.maxWidth="900px";
}else{
v.style.maxWidth="300px";
}
});
}

setInterval(adjustLayout,500);

function directShare(){
if(navigator.share){
navigator.share({
title:"Join my LinkUP meeting",
url:location.href
});
}else{
alert("Direct share not supported on this device");
}
}
function toggleHostPanel(){
let p=document.getElementById("hostPanel");
p.style.display=p.style.display==="flex"?"none":"flex";
}
function breakout(){
let room=prompt("Enter breakout room name:");
if(room){
alert("Joined breakout: "+room+" (demo)");
}
}

/* demo participants */
const demoUsers=["You (Host)","Rahul","Priya","Alex"];

const hostList=document.getElementById("hostUsers");

demoUsers.forEach(u=>{
let div=document.createElement("div");
div.className="host-user";
div.innerHTML=`${u} <button onclick="kickUser('${u}')">âŒ</button>`;
hostList.appendChild(div);
});

/* controls */

function muteAll(){
alert("All participants muted!");
}

function stopAllVideo(){
alert("All cameras stopped!");
}

let locked=false;
function lockMeeting(){
locked=!locked;
alert(locked?"Meeting Locked ğŸ”’":"Meeting Unlocked ğŸ”“");
}

function kickUser(name){
alert(name+" removed!");
}
const audioCtx=new AudioContext();
const analyser=audioCtx.createAnalyser();
const mic=audioCtx.createMediaStreamSource(stream);
mic.connect(analyser);

setInterval(()=>{
let data=new Uint8Array(analyser.frequencyBinCount);
analyser.getByteFrequencyData(data);
let volume=data.reduce((a,b)=>a+b)/data.length;

video.classList.toggle("speaking",volume>25);
},200);

function emojiReact(){
const emojis=["ğŸ‘","ğŸ”¥","ğŸ˜‚","â¤ï¸","ğŸ‘"];

const e=document.createElement("div");
e.textContent=emojis[Math.floor(Math.random()*emojis.length)];
e.style.position="fixed";
e.style.bottom="120px";
e.style.left=Math.random()*80+"%";
e.style.fontSize="40px";
e.style.animation="floatUp 2s linear";

document.body.appendChild(e);
setTimeout(()=>e.remove(),2000);
}

document.addEventListener("click",e=>{
if(e.target.tagName==="VIDEO"){
document.querySelectorAll("video").forEach(v=>v.classList.remove("spot"));
e.target.classList.add("spot");
}
});



</script>

</body>
</html>
